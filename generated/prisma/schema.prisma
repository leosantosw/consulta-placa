generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model email_verification_tokens {
  id         BigInt   @id @default(autoincrement())
  user_id    String   @db.Uuid
  token_hash String   @unique
  expires_at DateTime @db.Timestamptz(6)
  created_at DateTime @default(now()) @db.Timestamptz(6)
  users      users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model users {
  id                        String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                      String
  email                     String                      @unique @db.Citext
  password_hash             String
  email_verified            Boolean                     @default(false)
  active                    Boolean                     @default(true)
  created_at                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_at                DateTime                    @default(now()) @db.Timestamptz(6)
  email_verification_tokens email_verification_tokens[]
  wallet_transactions       wallet_transactions[]
  wallets                   wallets?
}

model wallet_transactions {
  id           BigInt   @id @default(autoincrement())
  user_id      String   @db.Uuid
  amount       Int
  reference_id String?
  created_at   DateTime @default(now()) @db.Timestamptz(6)
  entity_type  String?
  entity_key   String?
  users        users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([user_id, entity_type, entity_key, created_at(sort: Desc)], map: "idx_wallet_tx_entity_lookup")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model wallets {
  user_id    String   @id @db.Uuid
  balance    Int      @default(0)
  updated_at DateTime @default(now()) @db.Timestamptz(6)
  users      users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}
